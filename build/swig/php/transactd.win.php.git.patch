diff --git b/transactd.win.php a/transactd.win.php
index 74d54ba..289ad4f 100644
--- b/transactd.win.php
+++ a/transactd.win.php
@@ -1,4 +1,5 @@
 <?php
+namespace BizStation\Transactd;
 
 /* ----------------------------------------------------------------------------
  * This file was automatically generated by SWIG (http://www.swig.org).
@@ -2513,12 +2514,7 @@ class database extends nsdatabase {
 
 	function __clone() {
 		$r=database___clone($this->_cPtr);
-		if (is_resource($r)) {
-			$c=substr(get_resource_type($r), (strpos(get_resource_type($r), '__') ? strpos(get_resource_type($r), '__') + 2 : 3));
-			if (class_exists($c)) return new $c($r);
-			return new database($r);
-		}
-		return $r;
+		$this->__construct($r);
 	}
 
 	function create($uri,$type=0) {
@@ -2879,12 +2875,7 @@ class fielddefs {
 
 	function __clone() {
 		$r=fielddefs___clone($this->_cPtr);
-		if (is_resource($r)) {
-			$c=substr(get_resource_type($r), (strpos(get_resource_type($r), '__') ? strpos(get_resource_type($r), '__') + 2 : 3));
-			if (class_exists($c)) return new $c($r);
-			return new fielddefs($r);
-		}
-		return $r;
+		$this->__construct($r);
 	}
 
 	function indexByName($name) {
@@ -2915,6 +2906,51 @@ class fielddefs {
 }
 
 class field {
+	public function getFV() {
+		switch ($this->type()) {
+			case transactd::ft_integer:
+			case transactd::ft_uinteger:
+			case transactd::ft_autoinc:
+			case transactd::ft_autoIncUnsigned:
+			case transactd::ft_logical:
+			case transactd::ft_bit:
+				return $this->i64();
+			case transactd::ft_float:
+			case transactd::ft_decimal:
+			case transactd::ft_money:
+			case transactd::ft_numeric:
+			case transactd::ft_bfloat:
+			case transactd::ft_numericsts:
+			case transactd::ft_numericsa:
+			case transactd::ft_currency:
+				return $this->d();
+			case transactd::ft_mychar:
+			case transactd::ft_myvarchar:
+			case transactd::ft_mywchar:
+			case transactd::ft_mywvarchar:
+			case transactd::ft_mytext:
+			case transactd::ft_mydate:
+			case transactd::ft_mytime:
+			case transactd::ft_mydatetime:
+			case transactd::ft_mytimestamp:
+			case transactd::ft_date:
+			case transactd::ft_time:
+			case transactd::ft_datetime:
+			case transactd::ft_timestamp:
+			case transactd::ft_note:
+			case transactd::ft_zstring:
+				return $this->c_str();
+			case transactd::ft_string:
+			case transactd::ft_myvarbinary:
+			case transactd::ft_mywvarbinary:
+			case transactd::ft_myblob:
+				return $this->getBin();
+			default:
+				return $this->c_str();
+		}
+		return null;
+	}
+
 	public $_cPtr=null;
 	protected $_pData=array();
 
@@ -3005,7 +3041,141 @@ class field {
 	}
 }
 
-abstract class Record {
+class RecordIterator implements \Iterator {
+	private $_record_cPtr = null;
+	private $_position = 0;
+	private $_count = -1;
+	private $_field = null;
+	private $_fielddefs = null;
+
+	function __construct($record_cPtr, $fielddefs) {
+		$this->_record_cPtr = $record_cPtr;
+		$this->_position = 0;
+		$this->_count = Record_size($record_cPtr);
+		$this->_fielddefs = $fielddefs;
+		$this->_field = new field();
+	}
+
+	public function rewind() {
+		$this->_position = 0;
+	}
+
+	public function valid() {
+		return $this->_position < $this->_count;
+	}
+
+	public function current() {
+		Record_getFieldByIndexRef($this->_record_cPtr, $this->_position, $this->_field);
+		return $this->_field->getFV();
+	}
+
+	public function key() {
+		return $this->_fielddefs->getFielddef($this->_position)->nameA();
+	}
+
+	public function next() {
+		$this->_position++;
+	}
+}
+
+class Record implements \ArrayAccess, \Countable, \IteratorAggregate {
+	protected $_field = null;
+	protected $_fielddefs = null;
+
+	function __clone() {
+		$this->_field = new field();
+	}
+
+	// IteratorAggregate
+	public function getIterator() {
+		return new RecordIterator($this->_cPtr, $this->_fielddefs);
+	}
+
+	// ArrayAccess
+	public function offsetExists($offset) {
+		switch (\gettype($offset)) {
+			case "integer":
+				return $offset >= 0 && $offset < $this->count();
+			case "string":
+				return Record_indexByName($this->_cPtr, $offset) >= 0;
+			default:
+				return false;
+		}
+	}
+
+	public function offsetGet($offset) {
+		switch (\gettype($offset)) {
+			case "integer":
+				Record_getFieldByIndexRef($this->_cPtr, $offset, $this->_field);
+				break;
+			case "string":
+				Record_getFieldByNameRef($this->_cPtr, $offset, $this->_field);
+				break;
+			default:
+				throw new \OutOfRangeException();
+		}
+		return $this->_field->getFV();
+	}
+
+	public function offsetSet($offset, $value) {
+		throw new \BadMethodCallException();
+	}
+
+	public function offsetUnset($offset) {
+		throw new \BadMethodCallException();
+	}
+
+	// Countable
+	public function count() {
+		return Record_size($this->_cPtr);
+	}
+
+	// generator
+	function keys() {
+		$count = Record_size($this->_cPtr);
+		for ($i = 0; $i < $count; $i++) {
+			yield $this->_fielddefs->getFielddef($i)->nameA();
+		}
+	}
+
+	function values() {
+		$count = Record_size($this->_cPtr);
+		for ($i = 0; $i < $count; $i++) {
+			Record_getFieldByIndexRef($this->_cPtr, $i, $this->_field);
+			yield $this->_field->getFV();
+		}
+	}
+
+	// toArray
+	function keysArray() {
+		$ret = array();
+		$count = Record_size($this->_cPtr);
+		for ($i = 0; $i < $count; $i++) {
+			$ret[] = $this->_fielddefs->getFielddef($i)->nameA();
+		}
+		return $ret;
+	}
+
+	function valuesArray() {
+		$ret = array();
+		$count = Record_size($this->_cPtr);
+		for ($i = 0; $i < $count; $i++) {
+			Record_getFieldByIndexRef($this->_cPtr, $i, $this->_field);
+			$ret[] = $this->_field->getFV();
+		}
+		return $ret;
+	}
+
+	function toArray() {
+		$ret = array();
+		$count = Record_size($this->_cPtr);
+		for ($i = 0; $i < $count; $i++) {
+			Record_getFieldByIndexRef($this->_cPtr, $i, $this->_field);
+			$ret[$this->_fielddefs->getFielddef($i)->nameA()] = $this->_field->getFV();
+		}
+		return $ret;
+	}
+
 	public $_cPtr=null;
 	protected $_pData=array();
 
@@ -3025,6 +3195,8 @@ abstract class Record {
 	}
 	function __construct($h) {
 		$this->_cPtr=$h;
+		$this->_fielddefs = $this->fieldDefs();
+		$this->_field = new field();
 	}
 
 	function setInvalidRecord($v) {
@@ -3098,6 +3270,7 @@ class memoryRecord extends Record {
 		return Record::__get($var);
 	}
 	function __construct($h) {
+		parent::__construct($h);
 		$this->_cPtr=$h;
 	}
 
@@ -3117,6 +3290,21 @@ class memoryRecord extends Record {
 }
 
 class writableRecord extends memoryRecord {
+	// override ArrayAccess method (set value).
+	public function offsetSet($offset, $value) {
+		$this->offsetGet($offset);
+		switch ($this->_field->type()) {
+			case transactd::ft_string:
+			case transactd::ft_myvarbinary:
+			case transactd::ft_mywvarbinary:
+			case transactd::ft_myblob:
+				$this->_field->setFV($value, strlen($value));
+				break;
+			default:
+				$this->_field->setFV($value);
+		}
+	}
+
 	public $_cPtr=null;
 
 	function __set($var,$value) {
@@ -3134,6 +3322,7 @@ class writableRecord extends memoryRecord {
 		return memoryRecord::__get($var);
 	}
 	function __construct($h) {
+		parent::__construct($h);
 		$this->_cPtr=$h;
 	}
 
@@ -3525,6 +3714,8 @@ class recordsetQuery {
 
 class groupFuncBase extends recordsetQuery {
 	public $_cPtr=null;
+	private $targetName = '';
+	private $resultName = '';
 
 	function __set($var,$value) {
 		if ($var === 'thisown') return swig_transactd_alter_newobject($this->_cPtr,$value);
@@ -3546,10 +3737,12 @@ class groupFuncBase extends recordsetQuery {
 			$this->_cPtr=$v_or_targetName;
 			return;
 		}
+		$this->targetName = $v_or_targetName;
+		$this->resultName = $resultName;
 		switch (func_num_args()) {
 		case 0: $this->_cPtr=new_groupFuncBase(); break;
-		case 1: $this->_cPtr=new_groupFuncBase($v_or_targetName); break;
-		default: $this->_cPtr=new_groupFuncBase($v_or_targetName,$resultName);
+		case 1: $this->_cPtr=new_groupFuncBase($this->targetName); break;
+		default: $this->_cPtr=new_groupFuncBase($this->targetName,$this->resultName);
 		}
 	}
 
@@ -3558,7 +3751,8 @@ class groupFuncBase extends recordsetQuery {
 	}
 
 	function setTargetName($v) {
-		groupFuncBase_setTargetName($this->_cPtr,$v);
+		$this->targetName = $v;
+		groupFuncBase_setTargetName($this->_cPtr,$this->targetName);
 	}
 
 	function resultName() {
@@ -3566,7 +3760,8 @@ class groupFuncBase extends recordsetQuery {
 	}
 
 	function setResultName($v) {
-		groupFuncBase_setResultName($this->_cPtr,$v);
+		$this->resultName = $v;
+		groupFuncBase_setResultName($this->_cPtr,$this->resultName);
 	}
 
 	function resultKey() {
@@ -3709,12 +3904,15 @@ class sum extends groupFuncBase {
 			$this->_cPtr=$targetName;
 			return;
 		}
-		$this->_cPtr=new_sum($targetName,$resultName);
+		$this->targetName = $targetName;
+		$this->resultName = $resultName;
+		$this->_cPtr=new_sum($this->targetName,$this->resultName);
 	}
 }
 
 class count extends groupFuncBase {
 	public $_cPtr=null;
+	private $resultName = '';
 
 	function __set($var,$value) {
 		if ($var === 'thisown') return swig_transactd_alter_newobject($this->_cPtr,$value);
@@ -3736,7 +3934,8 @@ class count extends groupFuncBase {
 			$this->_cPtr=$resultName;
 			return;
 		}
-		$this->_cPtr=new_count($resultName);
+		$this->resultName = $resultName;
+		$this->_cPtr=new_count($this->resultName);
 	}
 }
 
@@ -3763,7 +3962,9 @@ class avg extends sum {
 			$this->_cPtr=$targetName;
 			return;
 		}
-		$this->_cPtr=new_avg($targetName,$resultName);
+		$this->targetName = $targetName;
+		$this->resultName = $resultName;
+		$this->_cPtr=new_avg($this->targetName,$this->resultName);
 	}
 }
 
@@ -3790,7 +3991,9 @@ class min extends sum {
 			$this->_cPtr=$targetName;
 			return;
 		}
-		$this->_cPtr=new_min($targetName,$resultName);
+		$this->targetName = $targetName;
+		$this->resultName = $resultName;
+		$this->_cPtr=new_min($this->targetName,$this->resultName);
 	}
 }
 
@@ -3817,11 +4020,127 @@ class max extends sum {
 			$this->_cPtr=$targetName;
 			return;
 		}
-		$this->_cPtr=new_max($targetName,$resultName);
+		$this->targetName = $targetName;
+		$this->resultName = $resultName;
+		$this->_cPtr=new_max($this->targetName,$this->resultName);
 	}
 }
 
-class RecordSet {
+class RecordSetIterator implements \SeekableIterator {
+	private $_recordset_cPtr = null;
+	private $_position = 0;
+	private $_fieldsBase_p_p = null;
+	private $_record = null;
+	private $_count = -1;
+
+	function __construct($recordset_cPtr, $fielddefs) {
+		$this->_recordset_cPtr = $recordset_cPtr;
+		$this->_position = 0;
+		$this->_fieldsBase_p_p = new_fieldsBase_p_p();
+		$this->_count = RecordSet_count($recordset_cPtr);
+		$this->_record = new Record(memoryRecord::createRecord($fielddefs));
+	}
+
+	function __destruct() {
+		delete_fieldsBase_p_p($this->_fieldsBase_p_p);
+	}
+
+	public function rewind() {
+		$this->_position = 0;
+	}
+
+	public function valid() {
+		return $this->_position < $this->_count;
+	}
+
+	public function current() {
+		RecordSet_getRow($this->_recordset_cPtr, $this->_position, $this->_fieldsBase_p_p);
+		$this->_record->_cPtr = fieldsBase_p_p_value($this->_fieldsBase_p_p);
+		return $this->_record;
+	}
+
+	public function key() {
+		return $this->_position;
+	}
+
+	public function next() {
+		$this->_position++;
+	}
+
+	public function seek($position) {
+		if ($position < 0 || $position >= $this->_count) {
+			throw new \OutOfBoundsException("invalid seek position ($position)");
+		}
+		$this->_position = $position;
+	}
+}
+
+class RecordSet implements \ArrayAccess, \Countable, \IteratorAggregate {
+	private $_fieldsBase_p_p = null;
+	private $_record = null;
+
+	function __destruct() {
+		transactd::delete_fieldsBase_p_p($this->_fieldsBase_p_p);
+	}
+
+	// IteratorAggregate
+	public function getIterator() {
+		return new RecordSetIterator($this->_cPtr, $this->fieldDefs());
+	}
+
+	// ArrayAccess
+	public function offsetExists($offset) {
+		return \gettype($offset) !== 'integer' && $offset >= 0 && $offset < $this->count();
+	}
+
+	public function offsetGet($offset) {
+		RecordSet_getRow($this->_cPtr, $offset, $this->_fieldsBase_p_p);
+		$this->_record->_cPtr = fieldsBase_p_p_value($this->_fieldsBase_p_p);
+		return $this->_record;
+	}
+
+	public function offsetSet($offset, $value) {
+		throw new \BadMethodCallException();
+	}
+
+	public function offsetUnset($offset) {
+		throw new \BadMethodCallException();
+	}
+
+	// random access
+	function first() {
+		if ($this->count() <= 0) {
+			throw new \OutOfBoundsException('no records in recordset');
+		}
+		return $this->offsetGet(0);
+	}
+
+	function last() {
+		if ($this->count() <= 0) {
+			throw new \OutOfBoundsException('no records in recordset');
+		}
+		return $this->offsetGet($this->count() - 1);
+	}
+
+	// generator
+	function range($start = null, $end = null) {
+		$count = $this->count();
+		if (\gettype($start) !== 'integer' || $start < 0) {
+			$i = 0;
+		} else {
+			$i = $start;
+		}
+		if (\gettype($end) !== 'integer' || $end < 0 || $end >= $count) {
+			$end = $count - 1;
+		}
+		while ($i <= $end) {
+			RecordSet_getRow($this->_cPtr, $i, $this->_fieldsBase_p_p);
+			$this->_record->_cPtr = fieldsBase_p_p_value($this->_fieldsBase_p_p);
+			yield $this->_record;
+			$i++;
+		}
+	}
+
 	public $_cPtr=null;
 	protected $_pData=array();
 
@@ -3843,34 +4162,27 @@ class RecordSet {
 	function __construct($r_=null) {
 		if (is_resource($r_) && get_resource_type($r_) === '_p_bzs__db__protocol__tdap__client__recordset') {
 			$this->_cPtr=$r_;
+			$this->_fieldsBase_p_p = new_fieldsBase_p_p();
+			$this->_record = new Record(memoryRecord::createRecord($this->fieldDefs()));
 			return;
 		}
 		switch (func_num_args()) {
 		case 0: $this->_cPtr=new_RecordSet(); break;
 		default: $this->_cPtr=new_RecordSet($r_);
 		}
+		$this->_fieldsBase_p_p = new_fieldsBase_p_p();
+		$this->_record = new Record(memoryRecord::createRecord($this->fieldDefs()));
 	}
 
 	function __clone() {
 		$r=RecordSet___clone($this->_cPtr);
 		if (is_resource($r)) {
-			$c=substr(get_resource_type($r), (strpos(get_resource_type($r), '__') ? strpos(get_resource_type($r), '__') + 2 : 3));
-			if (class_exists($c)) return new $c($r);
-			return new RecordSet($r);
+			$this->_cPtr = $r;
+		} else {
+			$this->_cPtr = $r->_cPtr;
 		}
-		return $r;
-	}
-
-	function first() {
-		$r=RecordSet_first($this->_cPtr);
-		$this->_cPtr = $r;
-		return $this;
-	}
-
-	function last() {
-		$r=RecordSet_last($this->_cPtr);
-		$this->_cPtr = $r;
-		return $this;
+		$this->_fieldsBase_p_p = new_fieldsBase_p_p();
+		$this->_record = new Record(memoryRecord::createRecord($this->fieldDefs()));
 	}
 
 	function size() {
@@ -4127,7 +4439,7 @@ class activeTable {
 		activeTable_release($this->_cPtr);
 	}
 
-	function __construct($mgr_or_db,$tableName) {
+	function __construct($mgr_or_db,$tableName=null) {
 		if (is_resource($mgr_or_db) && get_resource_type($mgr_or_db) === '_p_bzs__db__protocol__tdap__client__activeTable') {
 			$this->_cPtr=$mgr_or_db;
 			return;
