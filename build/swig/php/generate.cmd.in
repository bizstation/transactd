@REM ===============================================================
@REM    Copyright (C) 2013 BizStation Corp All rights reserved.
@REM 
@REM    This program is free software; you can redistribute it and/or
@REM    modify it under the terms of the GNU General Public License
@REM    as published by the Free Software Foundation; either version 2
@REM    of the License, or (at your option) any later version.
@REM 
@REM    This program is distributed in the hope that it will be useful,
@REM    but WITHOUT ANY WARRANTY; without even the implied warranty of
@REM    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
@REM    GNU General Public License for more details.
@REM 
@REM    You should have received a copy of the GNU General Public License
@REM    along with this program; if not, write to the Free Software 
@REM    Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  
@REM    02111-1307, USA.
@REM ===============================================================
call :GET_TRANSACTD_PHP_PATH "@SWIG_NATIVE_OUTFILE@"
if not exist "%TDPHPPATH%.correct" call :GENERATE_TRANSACTD_PHP_CORRECT

swig -c++ -php5 -DSWIGWIN -D_WIN32 -I"@SWIG_INC_PATH1@" -I"@SWIG_INC_PATH2@" @SWIG_ADDITONAL_OPTIONS@ -o "@SWIG_NATIVE_OUTFILE@" "@SWIG_INTERFACE_FILE@"
del "%TDPHPPATH%"
copy "%TDPHPPATH%.correct" "%TDPHPPATH%"

exit /b 0

:GENERATE_TRANSACTD_PHP_CORRECT
  copy "@SWIG_INTERFACE_FILE@" "@SWIG_INTERFACE_FILE@.org"
  findstr /V /B /C:"%%newobject" "@SWIG_INTERFACE_FILE@.org" > "@SWIG_INTERFACE_FILE@"
  swig -c++ -php5 -DSWIGWIN -D_WIN32 -I"@SWIG_INC_PATH1@" -I"@SWIG_INC_PATH2@" @SWIG_ADDITONAL_OPTIONS@ -o "@SWIG_NATIVE_OUTFILE@" "@SWIG_INTERFACE_FILE@"
  del "@SWIG_INTERFACE_FILE@"
  copy "@SWIG_INTERFACE_FILE@.org" "@SWIG_INTERFACE_FILE@"
  del "@SWIG_INTERFACE_FILE@.org"
  move "%TDPHPPATH%" "%TDPHPPATH%.correct"
  exit /b 0

:GET_TRANSACTD_PHP_PATH
  setlocal enabledelayedexpansion
  endlocal && set TDPHPPATH=%~dp1transactd.php
  exit /b 0
